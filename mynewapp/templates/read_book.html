{% extends 'master.html' %}
{% load static %}

{% block title %}Order Book{% endblock %}

{% block body %}
<div class="container">
    <div class="col-md-6 col-lg-6 col-xl-6 mx-auto">

        <form method="POST" action="{% url 'buy_now' %}" style="margin-bottom:50px">
            {% csrf_token %}

            <h2>Order Book</h2>
            <br>

            <div class="form-group">
                <label>Customer Name:-</label>
                <input type="text" name="user_name" value="{{user_name}}" class="form-control" readonly>
            </div>

            <div class="form-group">
                <label>Email:-</label>
                <input type="text" name="user_email" value="{{user_email}}" class="form-control" readonly>
            </div>

           <div class="form-group">
    <label>Book Name:-</label>
    <input type="text" name="book_name" id="name" class="form-control"
           value="{{book_name}}" readonly>
</div>

            <div class="form-group">
                <label>Quantity:-</label>
                <input type="number" name="quantity" id="quantity" class="form-control" value="1" min="1" required>
            </div>

            <div class="form-group">
                <label>Address:-</label>
                <textarea name="address" id="address" class="form-control" required></textarea>
            </div>

            <div class="form-group">
                <label>Date:-</label>
                <input type="date" name="date" id="date" min="{{date}}" class="form-control" required>
            </div>

            <div class="form-group">
                <label>Contact :-</label>
                <input type="number" name="mobile" value="{{user_contact}}" class="form-control" readonly>
            </div>

           <div class="form-group">
    <label>Total Price:-</label>
    <input type="number" name="total_price" id="total_price" class="form-control"
           value="{{price}}" readonly>
    <input type="hidden" id="base_price" value="{{price}}">
</div>

            <br>
            <h4>{{msg}}</h4>
            <h4>{{status}}</h4>

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
</div>

<script>
    // Get the input elements
    const quantityInput = document.getElementById('quantity');
    const total_priceInput = document.getElementById('total_price');
    const basePrice = document.getElementById('base_price').value;

    // Add an event listener for input changes
    quantityInput.addEventListener('input', function() {
        // Get the current quantity value
        const quantity = parseInt(quantityInput.value);

        // Check if quantity is a valid number and greater than 0
        if (quantity > 0) {
            // Calculate the new total price
            const newTotalPrice = basePrice * quantity;

            // Update the total price input field
            total_priceInput.value = newTotalPrice;
        } else {
            // If quantity is invalid, set total price to base price
            total_priceInput.value = basePrice;
        }
    });
</script>

{% endblock %}